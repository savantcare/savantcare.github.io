<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Q1) What is the goal of user experience of the forms? | Patient file</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="Big picture, server side and client side doc">
    <link rel="preload" href="/assets/css/0.styles.06f8e488.css" as="style"><link rel="preload" href="/assets/js/app.8f3a3e31.js" as="script"><link rel="preload" href="/assets/js/2.a375547c.js" as="script"><link rel="preload" href="/assets/js/66.ab2c7aa6.js" as="script"><link rel="prefetch" href="/assets/js/10.b8a72aea.js"><link rel="prefetch" href="/assets/js/11.e1e7b15d.js"><link rel="prefetch" href="/assets/js/12.6ca44530.js"><link rel="prefetch" href="/assets/js/13.b36337da.js"><link rel="prefetch" href="/assets/js/14.dc8ab0e0.js"><link rel="prefetch" href="/assets/js/15.19e6c60c.js"><link rel="prefetch" href="/assets/js/16.7c2336f5.js"><link rel="prefetch" href="/assets/js/17.aa23014e.js"><link rel="prefetch" href="/assets/js/18.1cfa84ef.js"><link rel="prefetch" href="/assets/js/19.e83b0f9a.js"><link rel="prefetch" href="/assets/js/20.d47153f0.js"><link rel="prefetch" href="/assets/js/21.9ee3e32b.js"><link rel="prefetch" href="/assets/js/22.f5567422.js"><link rel="prefetch" href="/assets/js/23.b2a578d0.js"><link rel="prefetch" href="/assets/js/24.c2afedaf.js"><link rel="prefetch" href="/assets/js/25.470f7031.js"><link rel="prefetch" href="/assets/js/26.10d04e43.js"><link rel="prefetch" href="/assets/js/27.bc866bfa.js"><link rel="prefetch" href="/assets/js/28.ed0787be.js"><link rel="prefetch" href="/assets/js/29.7e352406.js"><link rel="prefetch" href="/assets/js/3.a59bee54.js"><link rel="prefetch" href="/assets/js/30.2d72d1c7.js"><link rel="prefetch" href="/assets/js/31.9b334b7f.js"><link rel="prefetch" href="/assets/js/32.262d2e9c.js"><link rel="prefetch" href="/assets/js/33.a060fd4b.js"><link rel="prefetch" href="/assets/js/34.e8366f00.js"><link rel="prefetch" href="/assets/js/35.80e1c4d2.js"><link rel="prefetch" href="/assets/js/36.3a08d54d.js"><link rel="prefetch" href="/assets/js/37.0f972e9a.js"><link rel="prefetch" href="/assets/js/38.e4b7ce6c.js"><link rel="prefetch" href="/assets/js/39.7ee21b59.js"><link rel="prefetch" href="/assets/js/4.24208f23.js"><link rel="prefetch" href="/assets/js/40.952e7c9a.js"><link rel="prefetch" href="/assets/js/41.897cbac3.js"><link rel="prefetch" href="/assets/js/42.89180a75.js"><link rel="prefetch" href="/assets/js/43.5a3baeb2.js"><link rel="prefetch" href="/assets/js/44.058fd359.js"><link rel="prefetch" href="/assets/js/45.1a885c5b.js"><link rel="prefetch" href="/assets/js/46.a21e69da.js"><link rel="prefetch" href="/assets/js/47.5052dfb7.js"><link rel="prefetch" href="/assets/js/48.8c6abb32.js"><link rel="prefetch" href="/assets/js/49.3ac4f77f.js"><link rel="prefetch" href="/assets/js/5.794cfa30.js"><link rel="prefetch" href="/assets/js/50.e56a6bba.js"><link rel="prefetch" href="/assets/js/51.437c3545.js"><link rel="prefetch" href="/assets/js/52.f9c5095b.js"><link rel="prefetch" href="/assets/js/53.c8964207.js"><link rel="prefetch" href="/assets/js/54.f24ca1e9.js"><link rel="prefetch" href="/assets/js/55.a4461c51.js"><link rel="prefetch" href="/assets/js/56.7f9ff22b.js"><link rel="prefetch" href="/assets/js/57.de08da24.js"><link rel="prefetch" href="/assets/js/58.cb63f765.js"><link rel="prefetch" href="/assets/js/59.8c3505f2.js"><link rel="prefetch" href="/assets/js/6.b93ad3f0.js"><link rel="prefetch" href="/assets/js/60.078e4412.js"><link rel="prefetch" href="/assets/js/61.09a752b8.js"><link rel="prefetch" href="/assets/js/62.d47b4ec9.js"><link rel="prefetch" href="/assets/js/63.23950f72.js"><link rel="prefetch" href="/assets/js/64.468a3f57.js"><link rel="prefetch" href="/assets/js/65.1e1344a7.js"><link rel="prefetch" href="/assets/js/67.01db4c63.js"><link rel="prefetch" href="/assets/js/68.fca40e33.js"><link rel="prefetch" href="/assets/js/69.faa0acb4.js"><link rel="prefetch" href="/assets/js/7.e975ed69.js"><link rel="prefetch" href="/assets/js/70.41d1160f.js"><link rel="prefetch" href="/assets/js/71.2950a2a9.js"><link rel="prefetch" href="/assets/js/72.9b6386b8.js"><link rel="prefetch" href="/assets/js/73.32b81ec5.js"><link rel="prefetch" href="/assets/js/74.fb9e6ada.js"><link rel="prefetch" href="/assets/js/75.142a495e.js"><link rel="prefetch" href="/assets/js/76.8091b741.js"><link rel="prefetch" href="/assets/js/77.4214eb1f.js"><link rel="prefetch" href="/assets/js/78.f4be5c05.js"><link rel="prefetch" href="/assets/js/79.c9a52ce6.js"><link rel="prefetch" href="/assets/js/8.fbedc228.js"><link rel="prefetch" href="/assets/js/80.2cde76c0.js"><link rel="prefetch" href="/assets/js/81.3f01a8ed.js"><link rel="prefetch" href="/assets/js/82.156e07d8.js"><link rel="prefetch" href="/assets/js/9.5b4cb701.js">
    <link rel="stylesheet" href="/assets/css/0.styles.06f8e488.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Patient file</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/" class="sidebar-heading clickable router-link-active open"><span>Home</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/faq.html" class="sidebar-link">FAQ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/big-picture/" class="sidebar-heading clickable"><span>Big picture</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ptserver/" class="sidebar-heading clickable"><span>Server</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ptclient/" class="sidebar-heading clickable router-link-active"><span>Client</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/GLOSSARY.html" class="sidebar-link">Glossary</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="q1-what-is-the-goal-of-user-experience-of-the-forms"><a href="#q1-what-is-the-goal-of-user-experience-of-the-forms" class="header-anchor">#</a> Q1) What is the goal of user experience of the forms?</h1> <ol><li>Give visual feedback to the user that the data was added.
<ul><li>There are 2 tables below the form:
<ul><li>A. Data added this session: rem/cl/add.vue:46</li> <li>Uses rem/cl/add.vue:76:cfDataSavedToDBThisSessionSuccessfully()</li> <li>B. Error: Reminders attempleted but failed to save rem/cl/add.vue:54</li> <li>Uses rem/cl/add.vue:81:cfDataApiErrorThisSession</li></ul></li></ul></li> <li>Visual feedback should come close to where the user eyes are. The visual feedback should not be on top right corner.
<ul><li>Achived with 2 tables above.</li></ul></li> <li>Immediately allow the user to add one more.
<ul><li>rem/cl/add.vue:Onsubmit:145 is async</li></ul></li> <li>User should be able to add 1 more without taking another action with their mouse.
<ul><li>Description field has focus using v-on on the div.</li></ul></li> <li>While the data is being sent to the server allow the user to add one more.
<ul><li>same as point 3.</li></ul></li> <li>If user does &quot;add more&quot; and now there are 2 add more forms open. The first rem has 5 charecters and 2nd rem has 2 charecters.
On clicking submit the 1st should move down and the 2nd should stay up.
<ul><li>rem/cl/add.vue:Onsubmit:154 calls the api in the else part</li></ul></li></ol> <h1 id="q2-how-is-the-state-of-data-entered-in-the-form-managed-on-client-side"><a href="#q2-how-is-the-state-of-data-entered-in-the-form-managed-on-client-side" class="header-anchor">#</a> Q2) How is the state of data entered in the form managed on client side?</h1> <p>vuex orm field: rowStateInThisSession of type int</p> <p>e.g. cts/spi/rem/db/vuex-orm/rems:71</p> <h1 id="q3-what-are-the-different-possible-values-for-rowstateinthissession"><a href="#q3-what-are-the-different-possible-values-for-rowstateinthissession" class="header-anchor">#</a> Q3) What are the different possible values for rowStateInThisSession?</h1> <p>0 =&gt; Not known
1 =&gt; Got from DB. Same as DB.
2 =&gt; Created new on client
3 =&gt; Created as copy on client
4 =&gt; Changed on client
After 2 if there is success the state goes back to 1
5 =&gt; Client requested save to server. Now data validation on client side will start.
6 =&gt; form error on client side
7 =&gt; Data sent to server to save
8 =&gt; Data saved to server failed.</p> <p>Data is stored with the timeline</p> <h1 id="q4-what-are-the-different-possible-user-scenarios"><a href="#q4-what-are-the-different-possible-user-scenarios" class="header-anchor">#</a> Q4) What are the different possible user scenarios?</h1> <h3 id="before-hitting-submit-the-possibilities-are"><a href="#before-hitting-submit-the-possibilities-are" class="header-anchor">#</a> Before hitting submit the possibilities are:</h3> <div class="language- extra-class"><pre class="language-text"><code>add -&gt; enter 2 charecters -&gt; remove
                          -&gt; reset form
                          -&gt; Close form and destroy Ct Local variables.
      enter 4 charecters  -&gt; remove
                          -&gt; reset form
                          -&gt; Close form and destroy Ct Local variables.
add -&gt; enter 2 charecters -&gt; Add more -&gt; enter 4 charecters -&gt; Submit
</code></pre></div><h3 id="after-hitting-submit-the-possibilities-are"><a href="#after-hitting-submit-the-possibilities-are" class="header-anchor">#</a> After hitting submit the possibilities are:</h3> <p>onsubmit gets N number of rows.
Some rows are in state 234 (Created new -&gt; Changed -&gt; Requested save to server)
Some rows are in state 2345 (Created new -&gt; Changed -&gt; Requested save to server -&gt; form validation errors)
Incoming may be 2345 since user may hit submit without making changes</p> <p>Once submit button finishes the possibles states are:
2345
23467
23461</p> <p>New record changed on client but not saved = 23</p> <ul><li>See rem/cl/add.vue:114</li></ul> <p>New record after data is saved on server. rowStateInThisSession = 23461</p> <ul><li>See rem/cl/add.vue:189</li></ul> <h1 id="q5-why-not-set-rowstateinthissession-1-when-api-succeds"><a href="#q5-why-not-set-rowstateinthissession-1-when-api-succeds" class="header-anchor">#</a> Q5) Why not set rowStateInThisSession = 1 when api succeds?</h1> <ul><li>For the end user it is a matter of comfort to see the previous data in the table.</li></ul> <h1 id="q6-how-is-change-and-discontinued-handle"><a href="#q6-how-is-change-and-discontinued-handle" class="header-anchor">#</a> Q6) How is change and discontinued handle?</h1> <ol><li><p>Record is discontinued. Query sent is update. Value will be rowStateInThisSession =</p></li> <li><p>When a record is changed
Since temporal DB old is deleted and new is inserted. But from client side the query sent is update
rowStateInThisSession =</p></li></ol> <h1 id="q7-should-data-be-loaded-from-localstorage-or-state"><a href="#q7-should-data-be-loaded-from-localstorage-or-state" class="header-anchor">#</a> Q7) Should data be loaded from localstorage or state?</h1> <div class="language- extra-class"><pre><code>  There are 2 possibilities
    Possibility 1: There is no unsaved data
    Possibility 2: There is unsaved data on the client browser
                  2A: Unsaved data is in state / vuex
                  2B: Unsaved data is in Indexed DB
  When there is unsaved data we need to load the unsaved data

  The query to load data from vuex is:
  const arFromORM = ormRem.query().where('$isNew', true).get()

  The permanence of data is:
  Least permanane: data (local variable) of ct    -&gt; Does not survive Ct remounting
  Less permanance: State                          -&gt; Survives previous. Does not survive browser refresh
  Middle permancne: Index DB                      -&gt; Survives previous. Does not survice clean cache or using from diff browser
  Most permanent: Mysql                           -&gt; Survives all previous scenarios

  When Ct is mounted the data should come from:
    Step1: Mysql to get permanent data
    IndexDB: to get unsaved data in the client browser

  Why IndexDB and not state?
    When control comes here there are 2 possibilities:
      1. This is page refresh
      2. This is just Ct being remounted or mounted for the first time
      In both the above cases IndexDB will have the correct data
      State will have the correct data only when the Ct is being remounted.
  Should IndexDB be used?
    +Ves:
      Scenario 1: When browser is refreshed the first load of data will be very fast.
      Scenario 2: If there is some data edited and browser is refreshed that data is still there.
      Scenario 3: If there is some data edited and browser/laptop is rebooted that data is still there.
      Scenario 4: When user is not online then also the user can load the patient file.
    -ves:
      Scenario 1: Suppose doctor has added 1 rem but that is only on indexDB since doctor did not hit submit
                  Suppose doctor closes laptop for 2 days
                  when they come back after 2 days there are 3 new rems on the server
                  When doctor starts the browser, in the code I will have to:
                    1. Get data from mysql server.
                    2. Find data from indexDB where the isDirty or isNew flag is true
                    3. Then the data that is found to be different (unsaved data) needs to be inserted into the array that came back from mysql server
                    4. This array needs to be inserted into vuex
                    5. The new vuex needs to be synced with the storage.
    Decision on 8th July 2020 by VK/AG/TJ/SS/RR: Not to use indexDB
</code></pre></div><h1 id="q7-how-to-save-data-to-state-smartly"><a href="#q7-how-to-save-data-to-state-smartly" class="header-anchor">#</a> Q7) How to save data to state smartly.</h1> <p>Non smart way is to save data to state on every keystroke.
Why do we want a smart way to save data?
So that the system remains responsive.
There are a lot of listeners on this state and they will update themselves everytime there is a write to the vuexORM/rem</p> <h3 id="strategy-1-save-to-state-once-every-5-key-strokes"><a href="#strategy-1-save-to-state-once-every-5-key-strokes" class="header-anchor">#</a> Strategy 1: Save to state once every 5 key strokes,</h3> <div class="language- extra-class"><pre><code>    Disadvnatage?
    If the user types &quot;jai kali&quot; the state will only have &quot;jai k&quot; even if user exits the form after one hour
</code></pre></div><h3 id="strategy-2-each-time-you-save-to-state-you-store-the-time"><a href="#strategy-2-each-time-you-save-to-state-you-store-the-time" class="header-anchor">#</a> Strategy 2: Each time you save to state you store the time</h3> <div class="language- extra-class"><pre><code>    Ignore next save if 1 second has not passed.
    Disadvnatage?
    If the user types &quot;ja&quot; within 1 sec and then exits the state will only have j
</code></pre></div><h1 id="q8-should-bulk-created-be-used-out-of-10-reminders-set-what-if-9-got-created-successfuly-but-1-failed"><a href="#q8-should-bulk-created-be-used-out-of-10-reminders-set-what-if-9-got-created-successfuly-but-1-failed" class="header-anchor">#</a> Q8) Should bulk created be used Out of 10 reminders set what if 9 got created successfuly but 1 failed?</h1> <div class="language- extra-class"><pre><code>  // To keep code simple it was decided by VK on 13th July 2020 that for creasting 10 items we will fire 10 API calls.
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8f3a3e31.js" defer></script><script src="/assets/js/2.a375547c.js" defer></script><script src="/assets/js/66.ab2c7aa6.js" defer></script>
  </body>
</html>
